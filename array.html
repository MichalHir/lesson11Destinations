<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body> 
<!--3. נסו להוסיף גם חיפוש (כפתור חיפוש + תיבת טקסט )  שתציג רק את היעדים שחיפשתם-->
    <div id="destinationAdding">
        <div class="input-group">
            <input  id="newDes" class="form-control" placeholder="destination's name" aria-label="Recipient's username with two button addons">
            <button class="btn btn-primary" onclick="addDes()" type="button">add</button>
            <button class="btn btn-danger" onclick="popDes()" type="button">pop</button>
            <button class="btn btn-primary" onclick="serDes()" type="button">search</button>
            <button class="btn btn-primary" onclick="backDes()" type="button">back</button>
    </div>   
      <!-- <input id="newDes" />
      <button class="btn btn-primary" onclick="addDes()">add</button>
      <button class="btn btn-primary" onclick="popDes()">pop</button>
      <button class="btn btn-primary" onclick="serDes()">search</button> -->
    <div id="destinationsDisplay"></div>

    <script>
      let myDestinations = ['Barcelona', 'London', 'Thailand'];
      let myDestinationsCards = [];
      console.log(myDestinations);
      destinationsDisplay.innerHTML = DestinationsHTML();

      function addDes() {
        if (!myDestinations.includes(newDes.value) && newDes.value!='') {
          myDestinations.push(newDes.value);
          newDes.value = '';
          //   destinationsDisplay.innerHTML = myDestinations.join('<BR>');
          destinationsDisplay.innerHTML = DestinationsHTML();
        } else {
            newDes.value = '';
          alert('already in the list');
        }
      }

      function popDes() {
        myDestinations.pop();
        destinationsDisplay.innerHTML = DestinationsHTML();
        if (myDestinations.length == 0) {
          destinationsDisplay.innerHTML =
            '<div style="color:red">No Destinations</div>';
        }
      }

      function serDes() {
        destinationsDisplay.innerHTML=''
        let lowercase=''
        for (let i = 0; i < myDestinations.length; i++) {
           lowercase=myDestinations[i].toLocaleLowerCase()
           if (lowercase.lastIndexOf((newDes.value).toLocaleLowerCase())!=-1){
            destinationsDisplay.innerHTML+=`<div>${i + 1}${myDestinationsCards[i]}</div>`
          }
         }
        if (destinationsDisplay.innerHTML==''){
          alert ('no matches were found')
          destinationsDisplay.innerHTML ='<div style="color:red">No matches</div>';
        }
      }

      function delDes(num) {
        myDestinations.splice(num, 1);
        destinationsDisplay.innerHTML = DestinationsHTML();
      }

      function edDes(num) {
        if (newDes.value != '') {
          myDestinations[num] = newDes.value;
        }
        destinationsDisplay.innerHTML = DestinationsHTML();
      }

      function cardBuilder() {
        for (let i = 0; i < myDestinations.length; i++) {
          myDestinationsCards[i]=`<div class="card"">
            <div class="card-body" >
                <div> ${myDestinations[i]} <img src="https://picsum.photos/seed/${myDestinations[i]}/40/20"> </img>
                                    <button class="btn btn-danger" onclick="delDes(${i})">Delete</button><button class="btn btn-primary" onclick="edDes(${i})">edit</button>
                                  </div>`;
        }
      }

      function backDes() {
        destinationsDisplay.innerHTML = DestinationsHTML();
      }

      function DestinationsHTML() {
        let finalHtml = '';
        cardBuilder()
        for (let i = 0; i < myDestinations.length; i++) {
          const element = myDestinationsCards[i];
          // let elementHTML =
          // '<div>' +(i+1)+' '+ element + '<button onclick="delDes(i)">Delete</button></div>';
          // let elementHTML = `<div class="card"">
          //   <div class="card-body" >  (cards combined into eachother)
          //       <div>${i + 1} &nbsp ${element} <img src="https://picsum.photos/seed/${element}/40/20"> </img>
          //                           <button class="btn btn-danger" onclick="delDes(${i})">Delete</button><button class="btn btn-primary" onclick="edDes(${i})">edit</button>
          //                         </div>`;
            let elementHTML = 
                `<div>${i + 1} &nbsp ${element}</div> `;
          finalHtml = finalHtml + elementHTML;
        }
        return finalHtml;
      }
    </script>
  </body>
</html>
