<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body> 
<!--שעורי בית:
1. גרמו לאתר לעבוד - crud מלא . הוספת יעד, עריכת יעד - כולל להוסיף תמונה וציון ותיאור
2. גרמו לאתר לעבוד עם localstorage - כלומר לשמור את הנתונים שלכם
3. אתם מוזמנים להרחיב כמו - למיין את היעדים לפי ציון למשל. להוסיף לכל יעד רשימת מסעדות האהובות .
4. לכל מסעדה - אפשר להוסיף מיקום בגוגל ולתת לינק לגוגל-->
    <div id="destinationAdding">
        <div class="input-group">
            <input  id="newDes" onchange="serDes()" class="form-control" placeholder="destination's name" aria-label="Recipient's username with two button addons">
            <button class="btn btn-primary" onclick="addDes()" type="button">add</button>
            <button class="btn btn-danger" onclick="popDes()" type="button">pop</button>
            <button class="btn btn-primary" onclick="serDes()" type="button">search</button>
            <button class="btn btn-primary" onclick="backDes()" type="button">back</button>
    </div>   
      <!-- <input id="newDes" />
      <button class="btn btn-primary" onclick="addDes()">add</button>
      <button class="btn btn-primary" onclick="popDes()">pop</button>
      <button class="btn btn-primary" onclick="serDes()">search</button> --> 
    <div id="destinationsDisplay"></div> 

    <script>
      // let myDestinations = ['Barcelona', 'London', 'Thailand'];
      let myDestinations2 = JSON.parse(localStorage.getItem("myDestinations2"))
      myDest=JSON.parse(localStorage.getItem("mydestinations2"))
      // let myDest = [
      //   {
      //     name: 'Barcelona',
      //     score: 8.5,
      //     myRestaurant: ['chef', 'la bamba'],
      //     population: 50000,
      //     image: "https://picsum.photos/seed/${element}/40/20"
      //   },
      //   {
      //     name: 'London',
      //     score: 8.5,
      //     myRestaurant: ['chef', 'la bamba'],
      //     population: 50000,
      //     image: "https://picsum.photos/seed/${element}/40/20"
      //   },
      //   {
      //     name: 'Thailand',
      //     score: 8.5,
      //     myRestaurant: ['chef', 'la bamba'],
      //     population: 50000,
      //     image: "https://picsum.photos/seed/${element}/40/20"
      //   },
      // ];
      let myDestinationsCards = [];
      destinationsDisplay.innerHTML = DestinationsHTML();

      // function addDes() {
      //   if (!myDestinations.includes(newDes.value) && newDes.value!='') {
      //     myDestinations.push(newDes.value);
      //     newDes.value = '';
      //     destinationsDisplay.innerHTML = DestinationsHTML();
      //   } else {
      //       newDes.value = '';
      //     alert('already in the list');
      //   }
      // }

      function popDes() {
        myDest.pop();
        destinationsDisplay.innerHTML = DestinationsHTML();
        if (myDest.length == 0) {
          destinationsDisplay.innerHTML =
            '<div style="color:red">No Destinations</div>';
        }
      }

      function serDes() {
        destinationsDisplay.innerHTML=''
        let lowercase=''
        for (let i = 0; i < myDest.length; i++) {
           lowercase=myDestinations[i].toLocaleLowerCase()
           if (lowercase.lastIndexOf((newDes.value).toLocaleLowerCase())!=-1){
            destinationsDisplay.innerHTML+=`<div>${i + 1}${myDestinationsCards[i]}</div>`
          }
         }
        if (destinationsDisplay.innerHTML==''){
          alert ('no matches were found')
          destinationsDisplay.innerHTML ='<div style="color:red">No matches</div>';
        }
      }

      function delDes(num) {
        myDest.splice(num, 1);
        destinationsDisplay.innerHTML = DestinationsHTML();
      }

      // function edDes(num) {
      //   if (newDes.value != '') {
      //     myDestinations[num] = newDes.value;
      //   }
      //   destinationsDisplay.innerHTML = DestinationsHTML();
      // }

      function cardBuilder() {
        for (let i = 0; i < myDest.length; i++) {
          myDestinationsCards[i]=`<div class="card"">
            <div class="card-body" >
                <div> city:${myDest[i].name} <br> <img src="${myDest[i].image}"><br> score:${
             myDest[i].score
           }<br> restaurants:${myDest[i].myRestaurant}<br> population:${
            myDest[i].population
           }<br><button class="btn btn-danger" onclick="delDes(${i})">Delete</button><button class="btn btn-primary" onclick="edDes(${i})">edit</button>
                                  </div>`;
        }
      }

      function backDes() {
        destinationsDisplay.innerHTML = DestinationsHTML();
      }

      function DestinationsHTML() {
        let finalHtml = '';
        cardBuilder()
        for (let i = 0; i < myDest.length; i++) {
          const element = myDestinationsCards[i];
            let elementHTML = 
                `<div>${i + 1} &nbsp ${element}</div> `;
          finalHtml = finalHtml + elementHTML;
        }
        return finalHtml;
      }
      //destinationsDisplay.innerHTML=finalHtml
    </script>
  </body>
</html>
